<div class="table-container">
  <div class="table-scroll">
    <table border="1" id="csvTable"></table>
  </div>
</div>

<style>
@media (max-width: 768px) {
  #csvTable {
    min-width: 600px;
  }
}

@media (min-width: 1024px) {
  #csvTable th,
  #csvTable td {
    white-space: normal;
  }
}

.table-container {
  width: 100%;
  max-width: 1000px;
  margin: 40px auto;
  padding: 20px;
}

/* Horizontal scroll wrapper */
.table-scroll {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* Table styling */
#csvTable {
  width: max-content;
  max-width: 100%;
  border-collapse: collapse;
  table-layout: auto;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

#csvTable th,
#csvTable td {
  border: 1px solid #ddd;
  padding: 10px 14px;
  text-align: left;
  white-space: nowrap;
}

/* Sortable header styles */
#csvTable th {
  font-weight: bold;
  cursor: pointer;
  user-select: none;
  position: relative;
}

#csvTable th::after {
  content: " ↕";
  font-size: 0.75em;
  opacity: 0.6;
}

#csvTable th.sort-asc::after {
  content: " ↑";
}

#csvTable th.sort-desc::after {
  content: " ↓";
}
</style>

<script>
const googleSheetsCSV =
  "https://docs.google.com/spreadsheets/d/1mkU6r6YKaEeG1tqgrQfA0SluCg4g_MNeKSGBjmEyFdk/export?format=csv&id=1mkU6r6YKaEeG1tqgrQfA0SluCg4g_MNeKSGBjmEyFdk&gid=0";

fetch(googleSheetsCSV)
  .then(response => response.text())
  .then(data => {
    const rows = data.trim().split("\n");
    const table = document.getElementById("csvTable");

    rows.forEach((row, index) => {
      const tr = document.createElement("tr");

      row.split(",").forEach(cell => {
        const isHeader = index === 0;
        const td = document.createElement(isHeader ? "th" : "td");

        const trimmed = cell.trim();
        const num = parseFloat(trimmed);

        td.textContent =
          !isNaN(num) && trimmed.match(/^-?\d+(\.\d+)?$/)
            ? num.toFixed(2).replace(/\.00$/, "")
            : trimmed;

        tr.appendChild(td);
      });

      table.appendChild(tr);
    });

    makeTableSortable(table);
  })
  .catch(error => console.error("Error loading sheet:", error));

function makeTableSortable(table) {
  const headers = table.querySelectorAll("th");
  const directions = Array(headers.length).fill(true);

  headers.forEach((header, columnIndex) => {
    header.addEventListener("click", () => {
      const rows = Array.from(table.querySelectorAll("tr")).slice(1);
      const ascending = directions[columnIndex] = !directions[columnIndex];

      headers.forEach(h => h.classList.remove("sort-asc", "sort-desc"));
      header.classList.add(ascending ? "sort-asc" : "sort-desc");

      rows.sort((a, b) => {
        const aText = a.children[columnIndex].textContent.trim();
        const bText = b.children[columnIndex].textContent.trim();

        const aNum = parseFloat(aText);
        const bNum = parseFloat(bText);

        if (!isNaN(aNum) && !isNaN(bNum)) {
          return ascending ? aNum - bNum : bNum - aNum;
        }

        return ascending
          ? aText.localeCompare(bText, undefined, { numeric: true })
          : bText.localeCompare(aText, undefined, { numeric: true });
      });

      rows.forEach(row => table.appendChild(row));
    });
  });
}
</script>
